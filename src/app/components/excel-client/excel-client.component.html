<section *ngIf="isAuthenticated else login">
  <mat-progress-bar mode="query" [ngClass]="{'show-bar': isLoading}"></mat-progress-bar>
  <h4>{{ workbookName}} </h4>
  <mat-action-list dense>
    <h3 matSubheader>Worksheets</h3>
    <mat-list-item *ngFor="let worksheet of workSheets" (click)="onWorksheetSelection(worksheet)">
      {{ worksheet.name }}
    </mat-list-item>
  </mat-action-list>

  <div *ngIf="tables">
    <mat-action-list dense>
      <h3 matSubheader>Tables for sheet {{ selectedWorksheet.name }}</h3>
      <mat-list-item *ngFor="let table of tables" (click)="onTableSelection(table)">
        {{ table.name }}
      </mat-list-item>
    </mat-action-list>
  </div>

  <div *ngIf="rows">
    <h3 matSubheader>Rows</h3>
    <!-- Todo build iframe url from selected workbook -->
    <iframe style="width: 100%" width="402" height="346" frameborder="0" scrolling="no"
      src="https://robertdeveloper-my.sharepoint.com/personal/robert_robertdeveloper_onmicrosoft_com/_layouts/15/Doc.aspx?sourcedoc={b1590369-0380-4d5b-95ae-648b3f03fc89}&action=embedview&wdDownloadButton=True&wdInConfigurator=True"></iframe>
  </div>
</section>

<ng-template #login>
  <button mat-stroked-button color="primary" (click)="signIn()">Login</button>
</ng-template>
